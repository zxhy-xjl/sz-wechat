<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sz.wechat.dao.ComplaintMapper">
	<!-- 实体对象 -->
	<resultMap id="BaseResultMap" type="com.sz.wechat.entity.Complaint">
		<id column="PID" property="pid" jdbcType="VARCHAR"/>
		<result column="COMPANYID" property="companyid" jdbcType="VARCHAR"/>
		<result column="COMPLAINTIME" property="complaintime" jdbcType="VARCHAR"/>
		<result column="DISPOSESTATUS" property="disposestatus" jdbcType="VARCHAR"/>
		<result column="COMPLAINCONTENT" property="complaincontent" jdbcType="VARCHAR"/>
		<result column="DISPOSETIME" property="disposetime" jdbcType="VARCHAR"/>
		<result column="DISPOSEDEP" property="disposedep" jdbcType="VARCHAR"/>
		<result column="COMPLAINTYPE" property="complaintype" jdbcType="VARCHAR"/>
		<result column="DISPOSERESULT" property="disposeresult" jdbcType="VARCHAR"/>
		<result column="OPENID" property="openid" jdbcType="VARCHAR"/>
		<result column="COMPLAINPHOTO" property="complainphoto" jdbcType="BLOB"/>
	</resultMap>
	<!-- 数据字段 -->
	<sql id="Base_Column_List">
		PID, COMPANYID, COMPLAINTIME, DISPOSESTATUS, COMPLAINCONTENT,  DISPOSETIME, DISPOSEDEP, COMPLAINTYPE,DISPOSERESULT,OPENID,COMPLAINPHOTO
	</sql>
	
	<!-- 查询 -->
	<select id="getComplaintScoreByCompanyId" resultMap="BaseResultMap" parameterType="java.lang.String">
		SELECT  <include refid="Base_Column_List"/> FROM SZ_COMPLAINT WHERE (to_char(sysdate,'yyyymmdd')-COMPLAINTIME)&lt;= 10000 AND COMPANYID = #{companyid,jdbcType=VARCHAR} 
	</select>
	<select id="getComplaintScoreByCompanyIdAndOpenid" resultMap="BaseResultMap">
		SELECT  <include refid="Base_Column_List"/> FROM SZ_COMPLAINT WHERE (to_char(sysdate,'yyyymmdd')-COMPLAINTIME)&lt;= 10000 AND COMPANYID = #{0} AND OPENID=#{1}
	</select>
	<select id="getComplaintByCompanyId" resultMap="BaseResultMap" parameterType="java.lang.String">
		SELECT  <include refid="Base_Column_List"/> FROM SZ_COMPLAINT WHERE  COMPANYID = #{companyid,jdbcType=VARCHAR} 
	</select>
	<select id="getComplaintByOpenid" resultMap="BaseResultMap" parameterType="java.lang.String">
		SELECT  <include refid="Base_Column_List"/> FROM SZ_COMPLAINT WHERE (to_char(sysdate,'yyyymmdd')-COMPLAINTIME)&lt;= 10000 AND OPENID = #{openid,jdbcType=VARCHAR} 
	</select>
		<select id="getComplaintInfoByPid" resultMap="BaseResultMap" parameterType="java.lang.String">
		SELECT  <include refid="Base_Column_List"/> FROM SZ_COMPLAINT WHERE (to_char(sysdate,'yyyymmdd')-COMPLAINTIME)&lt;= 10000 AND PID = #{pid,jdbcType=VARCHAR} 
	</select>
	
	<!--修改  -->
	
	<!--插入  -->
	 <insert id="insertComplaint" parameterType="com.sz.wechat.entity.Complaint">
  insert into SZ_COMPLAINT
   (PID,COMPANYID,COMPLAINTIME,DISPOSESTATUS,COMPLAINCONTENT,DISPOSETIME,DISPOSEDEP,COMPLAINTYPE,DISPOSERESULT,OPENID,COMPLAINPHOTO)
    values
   (#{pid},#{companyid},#{complaintime},#{disposestatus},#{complaincontent},#{disposetime},#{disposedep},#{complaintype},#{disposeresult},#{openid},#{complainphoto})
 </insert>
 
	<select id="getComplaintCountByCompanyIdAndOpenid" resultType="java.lang.Integer" parameterType="java.lang.String">
		select count(*) from SZ_COMPLAINT where COMPANYID = #{companyid,jdbcType=VARCHAR} and OPENID = #{openid,jdbcType=VARCHAR}
		</select>
</mapper>